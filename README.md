# Идентификация паттернов поведения лабораторных крыс по последовательности видеокадров

Этот проект предназначен для анализа и классификации поведения лабораторных крыс на основе видеозаписей. Мы используем машинное обучение и компьютерное зрение для автоматической идентификации различных паттернов поведения, таких как ходьба, стояние и вставание на задние лапы. Алгоритмы, рассматриваемые в этом проекте, были разработаны в рамках стажировки в Научно-образовательной лаборатории «Техническое зрение» университета ИТМО. Основная цель исследования — автоматическая идентификация паттернов поведения лабораторных крыс на основе анализа последовательности видеокадров. Результаты исследования в дальнейшем будут использоваться для работы над выявлением паттернов поведения пациентов в больнице, что позволит в реальном времени, без участия врачей, наблюдать за пациентами.

## Описание файлов и папок

### Папки

- **classification_rearing**: Содержит результаты классификации для класса "крыса встала на задние лапы" и "крыса ходит/стоит".
- **classification_walking**: Содержит результаты классификации для класса "крыса ходит/стоит".

### Файлы

- **random_forest_model.joblib**: Содержит обученную модель Random Forest, используемую для классификации поведения крыс.
- **motion_detection.py**: Основной файл проекта, содержащий три класса:
  - `RatBehaviorClassifier`: Классифицирует поведение крысы, определяя, ходит ли она или стоит.
  - `RatLegsClassifier`: Классифицирует поведение крысы, определяя, встала ли она на задние лапы.
  - `RatBehaviorVisualizer`: Связывает два класса классификатора, считывает входные данные и визуализирует результаты классификации.

## Как использовать

1. Скачайте файлы:
- Скачайте файл с программой motion_detection.py.
-  Скачайте модель random_forest_model.joblib.
2. Создайте структуру папок:

- В той же директории, где находятся скачанные файлы, создайте папку classification. В ней будут сохраняться видео с результатами классификации.
- Создайте два пути: labels_walking/labels и videos_walking/videos.
  - В папке labels разместите данные разметки. Файлы разметки должны быть в формате .txt. В первой строке текстового файла содержатся данные о размере кадра. В последующих строках содержится информация о разметке кадров. Каждый кадр описывается в отдельной строке, включая номер кадра, координаты ограничивающего прямоугольника, координаты контрольных точек и их score.
  - В папке videos разместите видеофайлы.
- Названия видео и файлов разметки должны начинаться с walking, за которым следует номер, начиная с единицы, например, walking_1. Вы можете использовать другое название для своего датасета вместо walking.
3. Установите необходимые зависимости:
  ```bash
  pip install numpy opencv-python scipy matplotlib pandas scikit-learn joblib
  ```
4. Используйте программу для классификации:
- Объявите класс RatBehaviorVisualizer:
  ```bash
  visualizer = RatBehaviorVisualizer()
  ```
- Передайте название своего датасета, кадры которого вы хотите классифицировать:
  ```bash
  visualizer.process_behavior_type('walking')
  ```
